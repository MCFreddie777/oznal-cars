---
title: "Car price prediction"
output: html_document
cvičenie: "Utorok 9:00"
author: Bc. František Gič a Bc. Anton Rusňák
---
Načítanie knižníc
```{r}
library(data.table)
library(funModeling)
library(ggplot2)
library(Hmisc)
library(tidyverse)
library(dplyr)
```

Načítanie dát
```{r}
data <- read.csv(file = 'data/vehicles.csv', header = TRUE)
data = subset(data, select = -1)
```

# Prieskumná analýza

V tejto časti si prejdeme a popíšeme dataset. Bližšie sa pozrieme akých sú hodnôt a čo popisujú.   
```{r}
c('number of columns:', ncol(data))
c('number of rows',nrow(data))
```
```{r}
names = names(data)
names
```

K dispozícii máme necelých 460 tisíc záznamov. 

Atribútom máme celkovo 25. 

### Popis atribútov

*id* - unikátny identifikátor záznamu - číselný 10 miestny údaj

*url* - celá cesta, odkiaľ sa inzerát na vozidlo stiahol - url/string

*region* - oblasť, z akého sa auto predáva - string

*region_url* - cesta ku kategorii regionu na danom inzerčnom portáli - url/string

*price* - kúplno/predajná cena vozdila - číselný údaj

*year* = vyrobný rok vozdila - číselný údaj

*manufacturer* - výrobca vozidla - string

*model* - model vozdila - string

*condition* - stav vozidla v akom sa vozdilo nachádza

*cylinders* - počet valcov mootra daného vozidla

*fuel* - typ paliva - string

*odometer* - počet najazdených míľ  - číselný údaj 

*title_status* - stav vozidla

*transmission* - typ prevodovky vozidla - string

*VIN* - (doplnkový údaj) identifikačné číslo vozdila

*drive* - pohon vozidla - string

*size* - označenie veľkosti vozidla napriklad full-size - string

*type* - karosárske vyhotovenie vozidla - sedan, kupé, suv - string

*pain_color* - farba vozdila - string

*image_url* - cesta k obrázku daného vozdila - url/string

*description* - popis vozidla

*state* - oblasť predaja vozidla

*lat a long* - súradnice

*posting_data* - dátum uverejnenia inzerátu

Nižšie máme menšiu ukážku dát a ich bližšií špecifikáciu. 
```{r}
head(data,10)
```

```{r}
summary(data)
```

Ako významné atribúty s ktorými dalej budeme pracovať sú: 

  - price
  - year
  - manufacturer
  - model
  - condition
  - cylinders
  - fuel
  - odometer
  - transmission
  - vin
  - drive
  - size
  - type
  

## Analýza atribútov
### Rok (year)

```{r}
c('Počet prázdnych hodnôt:',sum(is.na(data$year)) )
```
```{r}
filter(data, is.na(year))
```

Ako možeme vidieť, atribút *rok* má 1050 prázdnych hodnôt. V amerike je bežné že sa autá prestavujú, je možné že predávajúci rok neudal z dôvodu, takejto prestavby, kde rok nehrá žiadnu rolu, napríklad: Karoseria vozidla je z roku 1970 a implementovaná technika z roku 2018. 



```{r}
ggplot(data, aes(x=year)) + 
  geom_histogram(bins = 121, fill= 6, color="#ffffff") +
  xlab("Rok") +
  ylab("Frekvencia") +
  scale_y_continuous(breaks = seq(0, 500000, by = 20000)) +
  scale_x_continuous(breaks = seq(1900, 2021, by = 5)) +
  theme(axis.text.x = element_text(angle = 90))
```

Podľa grafu môžeme vidieť, že pravažné množstvo vozdieil ktoré sa predáva je nanajvýš 20 rokov stará. Nájdu sa tu aj vozidlá staršie, ale tie sa prevažne inzerujäú na špecializovaných fórach, napríklad veterán. 

Toto rozdelenie sa dalo predpokladať,  kedže [priemerný vek vozidla je 12 rokov](https://www.caranddriver.com/news/a33457915/average-age-vehicles-on-road-12-years/) - 

### Výrobca (manufacturer)

```{r}
c('Počet prázdnych hodnôt:',sum(is.na(data$manufacturer)))
```

```{r}
filter(data, manufacturer == "")
```
```{r}
group_manu <- data %>%
  group_by(manufacturer) %>%
  summarize(frequency = n())

group_manu$manufacturer[which(group_manu$manufacturer == "")] <- "empty or wrong input"

group_manu
```
```{r}
ggplot(data = group_manu, aes(x = manufacturer, y = frequency)) +
  geom_bar( stat = "identity", fill= 2, color="#ffffff") +
  ylab("Aroma") +
  xlab("Odroda")  +
  theme(axis.text.x = element_text(angle = 90)) +
  scale_y_continuous(breaks = seq(0, 100000, by = 5000)) 


```


Možeme vidieť, že NA sa vždy neoplatí používať, v prípade výrobcu, velk0 mno6stvo ludí zle vyplnila políčka pre pridanie inzerátu. Meno výrobcu je spolu s modelom v atribúte *model*.


